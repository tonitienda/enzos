name: Build
description: Pull images, run unit tests, and build EnzOS artifacts.
inputs:
  build-image:
    description: Image name for the build environment.
    required: true
  build-tag:
    description: Tag to use when pulling the build image.
    required: true
  build-built:
    description: Whether the build image was built in the workflow run.
    required: true
  build-pushable:
    description: Whether the build image push is permitted for this event.
    required: true
  run-image:
    description: Image name for the run environment.
    required: true
  run-tag:
    description: Tag to use when pulling the run image.
    required: true
  run-built:
    description: Whether the run image was built in the workflow run.
    required: true
  run-pushable:
    description: Whether the run image push is permitted for this event.
    required: true
runs:
  using: composite
  steps:
    - name: Build artifacts
      shell: bash
      env:
        BUILD_IMAGE: ${{ inputs.build-image }}
        BUILD_TAG: ${{ inputs.build-tag }}
        BUILD_BUILT: ${{ inputs.build-built }}
        BUILD_PUSHABLE: ${{ inputs.build-pushable }}
        RUN_IMAGE: ${{ inputs.run-image }}
        RUN_TAG: ${{ inputs.run-tag }}
        RUN_BUILT: ${{ inputs.run-built }}
        RUN_PUSHABLE: ${{ inputs.run-pushable }}
      run: ./scripts/ci/build.sh
